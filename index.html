<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Muda Karya</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            color: #333;
            line-height: 1.6;
            position: relative;
            overflow-x: hidden;
        }
        
        /* Animated Background */
        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }
        
        @keyframes gradient {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }
        
        /* Header dengan Logo */
        header {
            color: white;
            padding: 1rem 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            display: flex;
            justify-content: center;
        }
        
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 1200px;
            padding: 0 20px;
            background: rgba(44, 62, 80, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            text-decoration: none;
            color: white;
            display: flex;
            align-items: center;
            transition: all 0.4s ease;
            padding: 10px 15px;
            border-radius: 20px;
        }
        
        .logo:hover {
            transform: scale(1.05);
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
            background: rgba(255, 255, 255, 0.1);
        }
        
        .logo img {
            height: 40px;
            margin-right: 10px;
            transition: all 0.4s ease;
        }
        
        .logo:hover img {
            transform: rotate(10deg);
        }
        
        nav ul {
            display: flex;
            list-style: none;
        }
        
        nav ul li {
            margin-left: 15px;
            position: relative;
        }
        
        nav ul li a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.4s ease;
            padding: 10px 15px;
            border-radius: 20px;
            display: block;
        }
        
        nav ul li a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: 5px;
            left: 15px;
            background-color: #3498db;
            transition: width 0.4s ease;
        }
        
        nav ul li a:hover {
            color: #3498db;
            background: rgba(255, 255, 255, 0.1);
        }
        
        nav ul li a:hover::after {
            width: calc(100% - 30px);
        }
        
        /* Main Content */
        main {
            margin-top: 80px;
            padding: 40px 20px;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }
        
        section {
            margin-bottom: 60px;
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.4s ease, box-shadow 0.4s ease;
            opacity: 0;
            transform: translateY(20px);
        }
        
        section.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        section:hover {
            transform: translateY(-5px) scale(1.01);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        h1, h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            transition: all 0.4s ease;
        }
        
        h1 {
            font-size: 2.5rem;
        }
        
        h2 {
            font-size: 2rem;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            display: inline-block;
        }
        
        h2:hover {
            color: #3498db;
            transform: skewX(-5deg);
        }
        
        h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        p {
            margin-bottom: 15px;
            font-size: 1.1rem;
            color: #555;
        }
        
        /* Project Section */
        .project {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 30px;
        }
        
        .project-cover-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            height: 600px;
            overflow: hidden;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.4s ease;
        }
        
        .project-cover-container:hover {
            transform: scale(1.02);
        }
        
        .project-cover {
            position: absolute;
            width: 100%;
            height: 100%;
            object-fit: contain;
            background-color: #ffffff;
            transition: opacity 1s ease;
        }
        
       
        
       
        
     
        .project-title {
            font-size: 1.8rem;
            margin: 20px 0;
            color: #2c3e50;
            cursor: pointer;
            text-align: center;
            transition: all 0.4s ease;
            position: relative;
            padding: 5px 15px;
            border-radius: 20px;
        }
        
        .project-title:hover {
            color: #3498db;
            background: rgba(52, 152, 219, 0.1);
        }
        
        .project-title::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: 0;
            left: 15px;
            background-color: #3498db;
            transition: width 0.4s ease;
        }
        
        .project-title:hover::after {
            width: calc(100% - 30px);
        }
        
        /* Finance Section */
        .finance-container {
            margin-top: 40px;
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        
        .finance-info {
            background: rgba(255, 255, 255, 0.8);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .finance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .finance-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .chart-container {
            width: 100%;
            height: 300px;
            margin-top: 20px;
        }
        
        /* Comic Reader Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.9);
            z-index: 2000;
            overflow-y: auto;
            padding: 20px;
        }
        
        .modal.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal-content {
            max-width: 800px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 0;
        }
        
        .comic-page {
            width: 100%;
            margin-bottom: 20px;
            border-radius: 5px;
            transition: transform 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.068);
        }
        
        .comic-page:hover {
            transform: scale(1.01);
        }
        
        .close-btn {
            position: fixed;
            top: 30px;
            right: 30px;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(0,0,0,0.5);
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }
        
        .close-btn:hover {
            transform: rotate(90deg) scale(1.2);
            color: #e74c3c;
            background: rgba(0,0,0,0.8);
        }
        
        /* Social Media Icons */
        .social-media {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        
        .social-icon {
            color: #2c3e50;
            font-size: 2rem;
            transition: all 0.4s ease;
            background: rgba(146, 14, 14, 0);
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            backdrop-filter: blur(5px);
        }
        
        .social-icon:hover {
            transform: translateY(-5px) scale(1.1);
        }
        
        .instagram:hover {
            color: #E1306C;
            background: rgba(225, 48, 108, 0.1);
        }
        
        .website:hover {
            color: #3498db;
            background: rgba(52, 152, 219, 0.1);
        }
        
        .whatsapp:hover {
            color: #25D366;
            background: rgba(37, 211, 102, 0.1);
        }
        
        /* Footer */
        footer {
            background: rgba(64, 91, 117, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: white;
            text-align: center;
            padding: 20px;
            margin-top: 40px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px 20px 0 0;
        }
        
        footer p {
            color: white;
        }
        
        /* Mobile Menu Toggle */
        .menu-toggle {
            display: none;
            cursor: pointer;
            font-size: 1.5rem;
            padding: 10px;
        }
        
        /* Loading Animation */
        .loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        .loader-content {
            text-align: center;
            color: white;
        }
        
        .loader-gif {
            width: 150px;
            height: 150px;
            object-fit: contain;
        }
        
        @media (max-width: 768px) {
            .header-container {
                flex-direction: row;
                justify-content: space-between;
                padding: 10px 15px;
                border-radius: 25px;
            }
            
            nav {
                position: fixed;
                top: 80px;
                left: 0;
                width: 100%;
                background: rgba(44, 62, 80, 0.9);
                backdrop-filter: blur(10px);
                -webkit-backdrop-filter: blur(10px);
                padding: 15px 0;
                border-radius: 0 0 20px 20px;
                transform: translateY(-150%);
                transition: transform 0.4s ease;
                z-index: 999;
            }
            
            nav.active {
                transform: translateY(0);
            }
            
            nav ul {
                flex-direction: column;
                align-items: center;
                margin-top: 0;
            }
            
            nav ul li {
                margin: 10px 0;
                margin-left: 0;
            }
            
            .menu-toggle {
                display: block;
            }
            
            .project-cover-container {
                height: 450px;
            }
            
            .logo span {
                display: none;
            }
            
            .logo img {
                margin-right: 0;
            }
            
            section {
                padding: 20px;
                margin-bottom: 40px;
            }
            
            h2 {
                font-size: 1.8rem;
            }
            
            .loader-gif {
                width: 100px;
                height: 100px;
            }
            
            .finance-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 480px) {
            .project-cover-container {
                height: 350px;
            }
            
            .comic-page {
                width: 95%;
            }
            
            .close-btn {
                top: 15px;
                right: 15px;
                width: 40px;
                height: 40px;
                font-size: 1.5rem;
            }
            
            .loader-gif {
                width: 80px;
                height: 80px;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loader">
        <div class="loader-content">
            <img src="Comp-1-1-unscreen.gif" alt="Loading" class="loader-gif">
        </div>
    </div>
    
    <!-- Animated Background -->
    <div class="animated-bg"></div>
    
    <!-- Header dengan Logo -->
    <header>
        <div class="header-container">
            <a href="#" class="logo">
                <img src="images/LOGO KARANG TARUNA MUDA KARYA.png" alt="Logo">
                <span>KARANG TARUNA MUDA KARYA</span>
            </a>
            <div class="menu-toggle" id="menuToggle">
                <i class="fas fa-bars"></i>
            </div>
            <nav id="mainNav">
                <ul>
                    <li><a href="#about">Profil</a></li>
                    <li><a href="#projects">Kegiatan</a></li>
                    <li><a href="#finance">Iuran</a></li>
                    <li><a href="#contact">Kontak</a></li>
                </ul>
            </nav>
        </div>
    </header>
    
    <!-- Main Content -->
    <main>
        <!-- About Section -->
        <section id="about">
            <h2>Profil Karang Taruna Muda Karya</h2>
            <p>Karang Taruna Muda Karya resmi didirikan pada 10 Oktober 2024 di Dusun Selaawi Desa Buniasih, sebagai bentuk kepedulian dan semangat pemuda untuk ikut andil dalam membangun lingkungan sosial yang aktif, peduli, dan produktif. Organisasi ini lahir dari kesadaran bersama bahwa pemuda bukan hanya penerus bangsa, tetapi juga penggerak utama perubahan di masyarakat.</p>
            <p>Awalnya, Muda Karya dibentuk oleh sekelompok pemuda yang sering berkumpul untuk kerja bakti, diskusi keagamaan, dan kegiatan sosial kecil-kecilan. Melihat semangat itu, para tokoh masyarakat dan pemerintah desa memberi dukungan penuh agar kegiatan mereka dilembagakan secara resmi. Maka lahirlah Karang Taruna Muda Karya, dengan tekad menjadi ruang bertumbuhnya pemuda yang beriman, berilmu, dan bermanfaat.</p>
        </section>
        
        <!-- Projects Section -->
        <section id="projects">
            <h2>Kegiatan</h2>
            <div class="project">
                <div class="project-cover-container" id="comicCover">
                    <img src="images/LOGO KARANG TARUNA MUDA KARYA.png" alt="Child of Fate Cover" class="project-cover primary">
                </div>
                <h3 class="project-title" id="comicTitle">Klik Kami</h3>
            </div>
        </section>
        
        <!-- Finance Section -->
    <section id="finance">
        <h2>Informasi Iuran</h2>
        <p>Setiap anggota Karang Taruna Muda Karya diwajibkan membayar iuran setiap tanggal 10 setiap bulannya. Iuran ini digunakan untuk mendanai berbagai kegiatan dan program kerja kami.</p>
        
        <div class="finance-container">
            <div class="finance-info">
                <h3>Statistik Iuran Bulan Ini</h3>
                <div class="chart-container">
                    <canvas id="financeChart"></canvas>
                </div>
            </div>
            
            <div class="finance-info">
                <h3>Detail Iuran per RT/RW</h3>
                <div class="finance-grid">
                    <div class="finance-card" id="rw1">
                        <h4>RW 1 </h4>
                        <div class="rt-data">
                            <p>RT 1: <span class="rt-value" data-rt="1">-</span></p>
                            <p>RT 2: <span class="rt-value" data-rt="2">-</span></p>
                            <p>RT 3: <span class="rt-value" data-rt="3">-</span></p>
                            <p>RT 4: <span class="rt-value" data-rt="4">395.000</span></p>
                        </div>
                        <p><strong>Total: <span class="rw-total">395.000</span></strong></p>
                    </div>
                    <div class="finance-card" id="rw2">
                        <h4>RW 2</h4>
                        <div class="rt-data">
                            <p>RT 1: <span class="rt-value" data-rt="1">-</span></p>
                            <p>RT 2: <span class="rt-value" data-rt="2">-</span></p>
                            <p>RT 3: <span class="rt-value" data-rt="3">-</span></p>
                        </div>
                        <p><strong>Total: <span class="rw-total">-</span></strong></p>
                    </div>
                    <div class="finance-card">
                        <h4>Total Keseluruhan</h4>
                        <p>Pemasukan: <span id="total-income">395.000</span></p>
                        <p>Pengeluaran: <span id="total-expense" contenteditable="true">-</span></p>
                        <p>Saldo: <span id="current-balance">395.000</span></p>
                    </div>
                </div>
            </div>
        </div>
    </section>
        
        <!-- Contact Section -->
        <section id="contact">
            <h2>Kontak</h2>
            <p>Mari bergabung bersama kami untuk menjadi lebih baik lagi.</p>
            <p>Email: ktmk.mudakarya@gmail.com</p>
            <p>Media Sosial:</p>
            <div class="social-media">
                <a href="-" target="_blank" class="social-icon instagram">
                    <i class="fab fa-instagram"></i>
                </a>
                <a href="#" target="_blank" class="social-icon website">
                    <i class="fas fa-globe"></i>
                </a>
                <a href="https://wa.me/" target="_blank" class="social-icon whatsapp">
                    <i class="fab fa-whatsapp"></i>
                </a>
            </div>
        </section>
    </main>
    
    <!-- Comic Reader Modal -->
    <div id="comicModal" class="modal">
        <span class="close-btn" id="closeModal">&times;</span>
        <div class="modal-content">
            <h2 style="color: white; margin-bottom: 30px;">Child of Fate</h2>
            <img src="images/prologue rev1.jpg" alt="Halaman 1" class="comic-page">
            <img src="images/prologue rev2.jpg" alt="Halaman 2" class="comic-page">
            <img src="images/prologue rev3.jpg" alt="Halaman 3" class="comic-page">
            <img src="images/prologue rev4.jpg" alt="Halaman 4" class="comic-page">
            <img src="images/prologue rev5.jpg" alt="Halaman 5" class="comic-page">
            <img src="images/prologue rev6.jpg" alt="Halaman 6" class="comic-page">
            <img src="images/prologue rev7.jpg" alt="Halaman 7" class="comic-page">
            <img src="images/prologue rev8.jpg" alt="Halaman 8" class="comic-page">
            <img src="images/prologue rev9.jpg" alt="Halaman 9" class="comic-page">
        </div>
    </div>
    
    <!-- Footer -->
    <footer>
        <p>&copy; 2025 KTMK. All rights reserved.</p>
    </footer>
    
    <script>
        // Wait for everything to load
        window.addEventListener('load', function() {
            // Hide loader
            document.querySelector('.loader').style.opacity = 0;
            setTimeout(() => {
                document.querySelector('.loader').style.display = 'none';
            }, 500);
            
            // Initialize elements
            const comicCover = document.getElementById('comicCover');
            const comicTitle = document.getElementById('comicTitle');
            const comicVideo = document.getElementById('comicVideo');
            const comicModal = document.getElementById('comicModal');
            const closeModal = document.getElementById('closeModal');
            const menuToggle = document.getElementById('menuToggle');
            const mainNav = document.getElementById('mainNav');
            
            // Open modal when cover or title is clicked
            comicCover.addEventListener('click', openComic);
            comicTitle.addEventListener('click', openComic);
            
            // Close modal when X is clicked
            closeModal.addEventListener('click', closeComic);
            
            // Close modal when clicking outside content
            window.addEventListener('click', function(event) {
                if (event.target === comicModal) {
                    closeComic();
                }
            });
            
            // Toggle mobile menu
            menuToggle.addEventListener('click', function() {
                mainNav.classList.toggle('active');
                this.querySelector('i').classList.toggle('fa-bars');
                this.querySelector('i').classList.toggle('fa-times');
            });
            
            // Close mobile menu when clicking a link
            document.querySelectorAll('nav a').forEach(link => {
                link.addEventListener('click', function() {
                    if (window.innerWidth <= 768) {
                        mainNav.classList.remove('active');
                        menuToggle.querySelector('i').classList.add('fa-bars');
                        menuToggle.querySelector('i').classList.remove('fa-times');
                    }
                });
            });
            
            // Video control for hover
            if (comicVideo) {
                comicCover.addEventListener('mouseenter', function() {
                    comicVideo.currentTime = 0;
                    comicVideo.play();
                });
                
                comicCover.addEventListener('mouseleave', function() {
                    comicVideo.pause();
                    comicVideo.currentTime = 0;
                });
            }
            
            function openComic() {
                comicModal.classList.add('show');
                document.body.style.overflow = 'hidden';
            }
            
            function closeComic() {
                comicModal.classList.remove('show');
                document.body.style.overflow = 'auto';
            }
            
            // Smooth scrolling for navigation links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    
                    document.querySelector(this.getAttribute('href')).scrollIntoView({
                        behavior: 'smooth'
                    });
                });
            });
            
            // Add animation to sections when they come into view
            const sections = document.querySelectorAll('section');
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('show');
                    }
                });
            }, { threshold: 0.1 });
            
            sections.forEach(section => {
                observer.observe(section);
            });
            
            // Add hover effect to project cover on mobile
            let isMobile = false;
            
            function checkMobile() {
                isMobile = window.innerWidth <= 768;
            }
            
            window.addEventListener('resize', checkMobile);
            checkMobile();
            
            if (isMobile && comicVideo) {
                // Touch events for mobile
                comicCover.addEventListener('touchstart', function() {
                    comicVideo.currentTime = 0;
                    comicVideo.play();
                    this.style.transform = 'scale(0.98)';
                });
                
                comicCover.addEventListener('touchend', function() {
                    comicVideo.pause();
                    comicVideo.currentTime = 0;
                    this.style.transform = 'scale(1)';
                });
            }
            
            // Initialize Finance Chart
            // Finance Data Structure
        const financeData = {
            months: ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Agu', 'Sep', 'Okt', 'Nov', 'Des'],
            currentMonthIndex: 4, // May is index 4 (0-based)
            years: [2025, 2025, 2025, 2025, 2025, 2025, 2025, 2025, 2025, 2025, 2025, 2025],
            income: [0, 0, 0, 0, 395000, 0, 0, 0, 0, 0, 0, 0],
            expense: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            rwData: {
                1: { // RW 1
                    1: 0, // RT 1
                    2: 0,  // RT 2
                    3: 0, // RT 3
                    4: 395.000  // RT 4
                },
                2: { // RW 2
                    1: 0,  // RT 1
                    2: 0, // RT 2
                    3: 0  // RT 3
                }
            }
        };

        // Initialize Finance Chart
        const ctx = document.getElementById('financeChart').getContext('2d');
        const financeChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: financeData.months,
                datasets: [
                    {
                        label: 'Pemasukan',
                        data: financeData.income,
                        backgroundColor: 'rgba(54, 162, 235, 0.7)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    },
                    {
                        label: 'Pengeluaran',
                        data: financeData.expense,
                        backgroundColor: 'rgba(255, 99, 132, 0.7)',
                        borderColor: 'rgba(255, 99, 132, 1)',
                        borderWidth: 1
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return 'Rp ' + value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
                            }
                        }
                    }
                },
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                let label = context.dataset.label || '';
                                if (label) {
                                    label += ': ';
                                }
                                label += 'Rp ' + context.raw.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
                                return label;
                            }
                        }
                    }
                }
            }
        });

        // Function to update all finance displays
        function updateFinanceDisplay() {
            // Update chart
            financeChart.data.datasets[0].data = financeData.income;
            financeChart.data.datasets[1].data = financeData.expense;
            financeChart.update();
            
            // Update RW data display
            for (const rw in financeData.rwData) {
                let rwTotal = 0;
                const rtData = financeData.rwData[rw];
                
                for (const rt in rtData) {
                    const value = rtData[rt];
                    document.querySelector(`#rw${rw} .rt-value[data-rt="${rt}"]`).textContent = 
                        value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
                    rwTotal += value;
                }
                
                document.querySelector(`#rw${rw} .rw-total`).textContent = 
                    rwTotal.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
            }
            
            // Calculate and update totals
            const currentIncome = financeData.income[financeData.currentMonthIndex];
            const currentExpense = financeData.expense[financeData.currentMonthIndex];
            
            document.getElementById('total-income').textContent = 
                currentIncome.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
            document.getElementById('total-expense').textContent = 
                currentExpense.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
            document.getElementById('current-balance').textContent = 
                (currentIncome - currentExpense).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
            
            // Update month display
            document.getElementById('currentMonth').textContent = 
                `${financeData.months[financeData.currentMonthIndex]} ${financeData.years[financeData.currentMonthIndex]}`;
        }

        // Function to calculate RW totals and update financeData
        function calculateTotals() {
            // Calculate RW totals and update financeData.income for current month
            let totalIncome = 0;
            for (const rw in financeData.rwData) {
                const rtData = financeData.rwData[rw];
                for (const rt in rtData) {
                    totalIncome += rtData[rt];
                }
            }
            financeData.income[financeData.currentMonthIndex] = totalIncome;
            
            // Update expense from editable field
            const expenseText = document.getElementById('total-expense').textContent;
            const expenseValue = parseInt(expenseText.replace(/\./g, '')) || 0;
            financeData.expense[financeData.currentMonthIndex] = expenseValue;
            
            // Update display
            updateFinanceDisplay();
        }

        // Edit RT values
        document.querySelectorAll('.edit-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const rw = this.getAttribute('data-rw');
                const rtData = financeData.rwData[rw];
                const rtElements = document.querySelectorAll(`#rw${rw} .rt-value`);
                
                rtElements.forEach(el => {
                    const rt = el.getAttribute('data-rt');
                    const currentValue = rtData[rt];
                    el.innerHTML = `<input type="text" class="rt-edit" value="${currentValue}" data-rt="${rt}">`;
                });
                
                
                this.parentElement.appendChild(saveBtn);
            });
        });

        // Month navigation
        document.getElementById('prevMonth').addEventListener('click', function() {
            if (financeData.currentMonthIndex > 0) {
                financeData.currentMonthIndex--;
                calculateTotals();
            }
        });

        document.getElementById('nextMonth').addEventListener('click', function() {
            if (financeData.currentMonthIndex < 11) {
                financeData.currentMonthIndex++;
                calculateTotals();
            }
        });

        // Expense editing
        document.getElementById('total-expense').addEventListener('blur', function() {
            calculateTotals();
        });

        // Format number while typing
        document.addEventListener('input', function(e) {
            if (e.target.classList.contains('rt-edit')) {
                const value = e.target.value.replace(/[^\d]/g, '');
                if (value) {
                    e.target.value = parseInt(value).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
                }
            }
        });

        // Initialize display
        updateFinanceDisplay();
        });
    </script>
</body>
</html>
